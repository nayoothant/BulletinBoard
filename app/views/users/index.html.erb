<h1>User List</h1>
<br>
  <%= form_tag({ :action => :search_user }, { :method => :get }) do %>
      <div class="field form-group row">
          <label class="col-sm-1 col-form-label">Name:</label>
          <%= text_field_tag :name, params[:name], class: "form-control col-sm-2" %>

          <label class="col-sm-1 col-form-label">Email:</label>
          <%= text_field_tag :email, params[:email], class: "form-control col-sm-2" %>

          <label class="col-sm-1 col-form-label">From:</label>
          <%= date_field_tag :from_date, params[:from_date], autocomplete: 'off', class: "form-control col-sm-2" %>

          <label class="col-sm-1 col-form-label">To:</label>
          <%= date_field_tag :to_date, params[:to_date], autocomplete: 'off', class: "form-control col-sm-2" %>
      </div>
      <div class="actions">
          <%= submit_tag ("Search"), class: 'btn btn-secondary float-right' %>
          <input type="reset" value="Clear" class="btn btn-dark float-right mb-3 mr-3">
      </div>
  <% end %>
<div class="table_container">
  <table id="dtBasicExample" class="table table-striped table-bordered table-sm" cellspacing="0" width="100%">
    <thead class="thead-dark">
      <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Email</th>
        <th>Created User</th>
        <th>Type</th>
        <th>Phone</th>
        <th>Date of Birth</th>
        <th>Address</th>
        <th>Created Date</th>
        <th>Updated Date</th>
        <th>Operation</th>
      </tr>
    </thead>

    <tbody>
      <% @users.each do |user| %>
        <tr>
          <td></td>
          <td><%= link_to user.name, user %></td>
          <td><%= user.email %></td>
          <td><%= user.created_user.name %></td>
          <td><%= user.role == '0' ? 'Admin' : 'User' %></td>
          <td><%= user.phone %></td>
          <td><%= user.dob.strftime('%Y/%m/%d') %></td>
          <td><%= user.address %></td>
          <td><%= user.created_at.strftime('%Y/%m/%d') %></td>
          <td><%= user.updated_at.strftime('%Y/%m/%d') %></td>
          <td><%= link_to 'Destroy', user, method: :delete, data: { confirm: 'Are you sure?' } %></td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>
<br>
<%= link_to 'New User', new_user_path , class:"btn btn-secondary"  %>

</div>
<style>
#dtBasicExample {
    counter-reset: tableCount;     
}
.counterCell:before {              
    content: counter(tableCount); 
    counter-increment: tableCount; 
}
</style>
<script>
$(document).ready(function () {
      var dataTable = null

    document.addEventListener("turbolinks:before-cache", function() {
      if (dataTable !== null) {
      dataTable.destroy()
      dataTable = null
      }
    })
  dataTable = $('#dtBasicExample').DataTable({
    "searching": false,
    "ordering": false,
    "bLengthChange": false,
    "info": false,
    "pageLength": 5,
  });
  dataTable.column(0).nodes().each( function (cell, i) {
      cell.innerHTML = i+1;
  } );
  $('.dataTables_length').addClass('bs-select');
});
</script>

